-- { echoOn }

DROP TABLE IF EXISTS t;
CREATE TABLE t (a UInt32, b UInt32) ENGINE=Memory;
INSERT INTO t VALUES (123, 42);
-- activate query result cache
SET experimental_query_result_cache_active_usage = true;
SET experimental_query_result_cache_passive_usage = true;
SET min_query_runs_for_query_result_cache = 3;
-- run query enough times to cache result
SELECT b from t;
42
SELECT b from t;
42
SELECT b from t;
42
SELECT * FROM system.queryresult_cache;
SELECT b FROM t	5826086239458893705	132
SELECT c FROM t	2681806077392269361	132
SELECT query, query_hash, result_size FROM system.queryresult_cache	8270831151736596638	551
SELECT b FROM t	5826086239458893705	132
SELECT a FROM t	2236632744409795448	132
-- -- query results are no longer in cache after drop
SYSTEM DROP QUERY RESULT CACHE;
SELECT * FROM system.queryresult_cache;
DROP TABLE t;
